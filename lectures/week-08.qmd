---
title: "QML - Week 8"
subtitle: "Bernoulli regression models"
author: "Stefano Coretta"
format: revealjs
bibliography: references.bib
---

```{r}
#| label: setup
#| include: false

library(tidyverse)
theme_set(theme_light())
library(brms)
library(posterior)
```

## Bouba and kiki

![](/img/Booba-Kiki.svg){fig-align="center"}

::: {style="font-size: 1rem;"}
@holland1964, @chen2016
:::

## Cross-modality

::: {.callout-note appearance="simple"}
-   There are links between the auditory and visual modalities.

-   A lot of research this concept, in fact originated with @kohler1929 who used "takete" and "maluma" (not the singer).

-   @koppensteiner2016 ask if not only shape, but also motion patterns enter in the cross-modality link.
:::

## Motion patterns

![](/img/pone.0150610.g001.PNG_L.png){fig-align="center" width="500"}

::: {style="font-size: 1rem;"}
@koppensteiner2016
:::

## Motion patterns

::: {.callout-note appearance="simple"}
@koppensteiner2016

-   46 students (24 females and 22 males; age M = 25.1 years, SD = 3.6) of the University of Vienna.

-   They saw a word (takete or maluma) and two stick-figures moving.

-   They had to pick the stick figure they thought was described by the word.
:::

## The data

```{r}
#| label: kopper
#| message: false
#| echo: true

kopper <- read_delim("data/koppensteiner2016/takete_maluma.txt")
kopper
```

## Accuracy

```{r}
#| label: fig-kopper-acc
#| fig-cap: "Accuracy by stimulus type."

kopper |> 
  ggplot(aes(Tak_Mal_Stim, fill = Answer)) +
  geom_bar(position = "fill") +
  labs(
    x = "Stimulus type", y = "Proportion"
  )
```

## Modelling accuracy

::: {.callout-note appearance="simple"}
-   We want to model the proportion of correct responses by stimulus type: both types should elicit the same level of accuracy.

-   We can use a Bernoulli regression model.
:::

. . .

```{r}
#| label: kop-mutate
#| echo: true

kopper <- kopper |> 
  mutate(
    Answer_f = factor(Answer, levels = c("WRONG", "CORRECT"))
  )
levels(kopper$Answer_f)
```

## Accuracy: Bernoulli regression

```{r}
#| label: kop-bm
#| echo: true

kop_bm <- brm(
  Answer_f ~ Tak_Mal_Stim,
  data = kopper,
  family = bernoulli,
  cores = 4,
  seed = 9128,
  file = "cache/kop_bm"
)
```

## Accuracy: model summary

```{r}
#| label: kop-bm-summ
#| echo: true

summary(kop_bm)

```

## Expected predictions of accuracy

```{r}
#| label: kop-bm-cond
#| warning: false
#| message: false
#| fig-align: center

conditional_effects(kop_bm)
```

## Credible intervals of the difference

```{r}
#| label: kop-bm-ci
#| echo: true
#| code-line-numbers: "|1|3-10|11"

kop_bm_draws <- as_draws_df(kop_bm)

kop_bm_draws |> 
  summarise(
    `90%` = paste0("[", paste(quantile2(b_Tak_Mal_StimTakete, c(0.05, 0.95)) |> round(2), collapse = ", "), "]"),
    `80%` = paste0("[", paste(quantile2(b_Tak_Mal_StimTakete, c(0.1, 0.9)) |> round(2), collapse = ", "), "]"),
    `70%` = paste0("[", paste(quantile2(b_Tak_Mal_StimTakete, c(0.15, 0.85)) |> round(2), collapse = ", "), "]"),
    `60%` = paste0("[", paste(quantile2(b_Tak_Mal_StimTakete, c(0.2, 0.8)) |> round(2), collapse = ", "), "]"),
    `40%` = paste0("[", paste(quantile2(b_Tak_Mal_StimTakete, c(0.3, 0.7)) |> round(2), collapse = ", "), "]")
  ) |> 
  knitr::kable(align = c("ccccc"))

```

## Is there a difference in accuracy by stimulus type?

::: {.callout-note appearance="simple"}
-   According to the model, the difference in log-odds is \[-0.25, 0.56\] at 95% probability.

-   Only at 40% probability we can argue for an increase in log-odds for takete stimuli between 0.04 and 0.27.

-   We can't argue for or against a difference.
    We just do not know.
:::

## References
