{
  "hash": "024d2a4dbf6346c522b86c7140a7afd9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Interactive plotting with Plotly\"\nsubtitle: \"Learn how to create interactive plots with Plotly\"\nformat: \n  html:\n    css: [webex.css]\n    include-after-body: [webex.js]\ndate: 2024-09-13\n---\n\n::: {.cell}\n\n:::\n\n\n\n::: callout-warning\n## Prerequisites\n\n- [Advanced plotting](plot-advance.qmd)\n\n:::\n\n## Overview\n\n[Plotly](https://plotly.com) is an Open Source graphing system, with interfaces to major languages like Python and R.\n\nThe [plotly](https://plotly.com/r/) R package allows you to make your ggplot2 plots interactive, or you can always create interactive plots with plotly directly.\n\nThis tutorial will show a simple example of each approach, but we refer you to the R package documentation for a full tour.\n\n## Add interactivity to a ggplot2 plot\n\nLet's recreate the Aggregated Endangerment Status (AES) plot from [Bar charts](bar-charts.qmd).\n\nFirst let's read the data.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nglot_status <- readRDS(\"data/coretta2022/glot_status.rds\")\n```\n:::\n\n\n\nThen let's create the plot. This time we will plot all macro-areas and we need to save the `ggplot()` outout to a variable.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naes_plot <- glot_status |>\nggplot(aes(x = Macroarea, fill = status)) +\n  geom_bar(position = \"fill\") +\n  labs(\n    x = \"Macro-area\",\n    y = \"Proportion\",\n    fill = \"Endangerment\"\n  )\n```\n:::\n\n\n\nFinally, we can use the `ggplotly()` function from the plotly package to make our ggplot2 plot interactive!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplotly(aes_plot)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-56221ebbe9cb17d3bbf0\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-56221ebbe9cb17d3bbf0\">{\"x\":{\"data\":[{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.40525409130060291,0.99097065462753953,0.67357512953367871,0.90283400809716596,0.61976320582877964,0.95231416549789616],\"x\":[1,2,3,4,5,6],\"y\":[0.59474590869939714,0.0090293453724604733,0.32642487046632129,0.097165991902834037,0.38023679417122036,0.047685834502103841],\"text\":[\"count: 0.594745909<br />Macroarea: Africa<br />status: not_endangered\",\"count: 0.009029345<br />Macroarea: Australia<br />status: not_endangered\",\"count: 0.326424870<br />Macroarea: Eurasia<br />status: not_endangered\",\"count: 0.097165992<br />Macroarea: North America<br />status: not_endangered\",\"count: 0.380236794<br />Macroarea: Papunesia<br />status: not_endangered\",\"count: 0.047685835<br />Macroarea: South America<br />status: not_endangered\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(248,118,109,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"not_endangered\",\"legendgroup\":\"not_endangered\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.24289405684754523,0.97742663656884876,0.45129533678756478,0.65991902834008098,0.41666666666666669,0.8134642356241234],\"x\":[1,2,3,4,5,6],\"y\":[0.16236003445305769,0.013544018058690765,0.22227979274611392,0.24291497975708498,0.20309653916211295,0.13884992987377276],\"text\":[\"count: 0.162360034<br />Macroarea: Africa<br />status: threatened\",\"count: 0.013544018<br />Macroarea: Australia<br />status: threatened\",\"count: 0.222279793<br />Macroarea: Eurasia<br />status: threatened\",\"count: 0.242914980<br />Macroarea: North America<br />status: threatened\",\"count: 0.203096539<br />Macroarea: Papunesia<br />status: threatened\",\"count: 0.138849930<br />Macroarea: South America<br />status: threatened\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(183,159,0,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"threatened\",\"legendgroup\":\"threatened\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.086132644272179162,0.8893905191873589,0.21554404145077721,0.46153846153846156,0.12295081967213115,0.55119214586255261],\"x\":[1,2,3,4,5,6],\"y\":[0.15676141257536608,0.088036117381489865,0.23575129533678757,0.19838056680161942,0.29371584699453557,0.26227208976157079],\"text\":[\"count: 0.156761413<br />Macroarea: Africa<br />status: shifting\",\"count: 0.088036117<br />Macroarea: Australia<br />status: shifting\",\"count: 0.235751295<br />Macroarea: Eurasia<br />status: shifting\",\"count: 0.198380567<br />Macroarea: North America<br />status: shifting\",\"count: 0.293715847<br />Macroarea: Papunesia<br />status: shifting\",\"count: 0.262272090<br />Macroarea: South America<br />status: shifting\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,186,56,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"shifting\",\"legendgroup\":\"shifting\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.062876830318690791,0.79006772009029347,0.16217616580310881,0.40080971659919029,0.061475409836065573,0.50490883590462832],\"x\":[1,2,3,4,5,6],\"y\":[0.023255813953488372,0.099322799097065428,0.0533678756476684,0.060728744939271273,0.061475409836065573,0.04628330995792429],\"text\":[\"count: 0.023255814<br />Macroarea: Africa<br />status: moribund\",\"count: 0.099322799<br />Macroarea: Australia<br />status: moribund\",\"count: 0.053367876<br />Macroarea: Eurasia<br />status: moribund\",\"count: 0.060728745<br />Macroarea: North America<br />status: moribund\",\"count: 0.061475410<br />Macroarea: Papunesia<br />status: moribund\",\"count: 0.046283310<br />Macroarea: South America<br />status: moribund\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,191,196,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"moribund\",\"legendgroup\":\"moribund\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0.050818260120585705,0.64559819413092556,0.12849740932642487,0.29554655870445345,0.034608378870673952,0.42496493688639553],\"x\":[1,2,3,4,5,6],\"y\":[0.012058570198105086,0.14446952595936791,0.033678756476683946,0.10526315789473684,0.026867030965391621,0.079943899018232789],\"text\":[\"count: 0.012058570<br />Macroarea: Africa<br />status: nearly_extinct\",\"count: 0.144469526<br />Macroarea: Australia<br />status: nearly_extinct\",\"count: 0.033678756<br />Macroarea: Eurasia<br />status: nearly_extinct\",\"count: 0.105263158<br />Macroarea: North America<br />status: nearly_extinct\",\"count: 0.026867031<br />Macroarea: Papunesia<br />status: nearly_extinct\",\"count: 0.079943899<br />Macroarea: South America<br />status: nearly_extinct\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(97,156,255,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"nearly_extinct\",\"legendgroup\":\"nearly_extinct\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null},{\"orientation\":\"v\",\"width\":[0.89999999999999991,0.90000000000000013,0.90000000000000036,0.90000000000000036,0.90000000000000036,0.90000000000000036],\"base\":[0,0,0,0,0,0],\"x\":[1,2,3,4,5,6],\"y\":[0.050818260120585705,0.64559819413092556,0.12849740932642487,0.29554655870445345,0.034608378870673952,0.42496493688639553],\"text\":[\"count: 0.050818260<br />Macroarea: Africa<br />status: extinct\",\"count: 0.645598194<br />Macroarea: Australia<br />status: extinct\",\"count: 0.128497409<br />Macroarea: Eurasia<br />status: extinct\",\"count: 0.295546559<br />Macroarea: North America<br />status: extinct\",\"count: 0.034608379<br />Macroarea: Papunesia<br />status: extinct\",\"count: 0.424964937<br />Macroarea: South America<br />status: extinct\"],\"type\":\"bar\",\"textposition\":\"none\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(245,100,227,1)\",\"line\":{\"width\":1.8897637795275593,\"color\":\"transparent\"}},\"name\":\"extinct\",\"legendgroup\":\"extinct\",\"showlegend\":true,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"frame\":null}],\"layout\":{\"margin\":{\"t\":26.228310502283108,\"r\":7.3059360730593621,\"b\":40.182648401826498,\"l\":48.949771689497723},\"plot_bgcolor\":\"rgba(235,235,235,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[0.40000000000000002,6.5999999999999996],\"tickmode\":\"array\",\"ticktext\":[\"Africa\",\"Australia\",\"Eurasia\",\"North America\",\"Papunesia\",\"South America\"],\"tickvals\":[1,2,3,3.9999999999999996,5,6],\"categoryorder\":\"array\",\"categoryarray\":[\"Africa\",\"Australia\",\"Eurasia\",\"North America\",\"Papunesia\",\"South America\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"Macro-area\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-0.050000000000000003,1.05],\"tickmode\":\"array\",\"ticktext\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"tickvals\":[0,0.25,0.5,0.75,1],\"categoryorder\":\"array\",\"categoryarray\":[\"0.00\",\"0.25\",\"0.50\",\"0.75\",\"1.00\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.6529680365296811,\"tickwidth\":0.66417600664176002,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":11.68949771689498},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(255,255,255,1)\",\"gridwidth\":0.66417600664176002,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"Proportion\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":null,\"line\":{\"color\":null,\"width\":0,\"linetype\":[]},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":true,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.8897637795275593,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":11.68949771689498},\"title\":{\"text\":\"Endangerment\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":14.611872146118724}}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"17c555696cf25\":{\"x\":{},\"fill\":{},\"type\":\"bar\"}},\"cur_data\":\"17c555696cf25\",\"visdat\":{\"17c555696cf25\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/htmltools-fill-0.5.8.1/fill.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}