{
  "hash": "6b6f9863de269133ba19548718e53f5e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data analysis workflow: Part 2\"\nauthor: \"Stefano Coretta\"\nformat: mono-light-revealjs\neditor: source\nfilters:\n  - tachyonsextra\nexecute: \n  echo: true\nknitr: \n  opts_chunk: \n    fig.width: 7\n    fig.align: center\n---\n\n\n\n## Research process cycle: Overview\n\n\n\n\n\n\n\n![](/img/res-process-cycle.png){fig-align=\"center\"}\n\n## Research questions and hypothesis\n\n::: box-tip\nTwo case studies:\n\n-   **(Week 8) Descriptive and exploratory**: Do British infants use a different number of gestures depending on their cultural background?\n\n-   **(This week) Explanatory and corroboratory**: vowel duration and gesture distance.\n:::\n\n## Intrinsic vowel duration: Future study\n\n::: box-note\n**High vowels tend to be shorter than low vowels.**\n:::\n\n::: box-tip\n**American English** in Lieberman and Kubaska 1979, Turk et al. 1994, Tauberer and Evanini 2009, Toivonen et al. 2015, Wilson and Chodroff 2017; **Dutch** in Bundgaard 1980; **Swedish** in Toivonen et al. 2015.\n:::\n\n## Distance to target\n\n![](/img/eke-aka.png){fig-align=\"center\" width=\"700\"}\n\n## Source of intrinsic vowel duration\n\n::: {layout-ncol=\"2\"}\n![Distance to target (Turk et al. 1994)](/img/intrinsic.png){#fig-dist fig-align=\"center\" width=\"500\"}\n\n![Phonologisation (Toivonen et al. 2015)](/img/intrinsic-phonologised.png){#fig-phon fig-align=\"center\" width=\"425\"}\n:::\n\n## Variables of interest\n\n| Outcome             | Predictors                      |\n|---------------------|---------------------------------|\n| Vowel duration (ms) | Vowel (quality)                 |\n|                     | Distance to vocalic target (mm) |\n|                     | Speech rate (syl/s)             |\n\n## Models of intrinsic vowel duration\n\n![](/img/vdur-dags-art.png){fig-align=\"center\"}\n\n## Research Hypotheses\n\n::: box-tip\nA. Vowel duration is entirely determined by the distance to vowel target.\n\nB. Vowel duration is entirely determined by stored durational targets.\n\nC. Vowel duration is not entirely determined by distance to vowel target only and stored durational targets are also necessary.\n:::\n\n## Research context overview\n\n+-------------------------+---------------------------------------------------------------------------------------------------------------------------------+\n| **Topic**               | Intrinsic vowel duration                                                                                                        |\n+-------------------------+---------------------------------------------------------------------------------------------------------------------------------+\n| **Research problem**    | There are competing models of gestural duration.                                                                                |\n+-------------------------+---------------------------------------------------------------------------------------------------------------------------------+\n| **Goal**                | Assessing these models against empirical data. (Comparing the fit of different models)                                          |\n+-------------------------+---------------------------------------------------------------------------------------------------------------------------------+\n| **Research question**   | Which of three possible models of gestural duration are corroborated?                                                           |\n+-------------------------+---------------------------------------------------------------------------------------------------------------------------------+\n| **Research hypotheses** | A. Vowel duration is entirely determined by the distance to vowel target.                                                       |\n|                         |                                                                                                                                 |\n|                         | B. Vowel duration is entirely determined by stored durational targets.                                                          |\n|                         |                                                                                                                                 |\n|                         | C. Vowel duration is not entirely determined by distance to vowel target only and stored durational targets are also necessary. |\n+-------------------------+---------------------------------------------------------------------------------------------------------------------------------+\n\n## Causal inference\n\n::: box-tip\n-   **Causal inference** approach: think about the causal relationship of variables to determine statistical models.\n\n-   Directed Acyclic Graphs, or **DAGs**.\n\n-   Demo on [DAGitty](https://www.dagitty.net/dags.html).\n:::\n\n. . .\n\n::: box-note\nTo learn more about Causal Inference:\n\n-   [Statistical Rethinking 2023 - 05 - Elemental Confounds](https://youtu.be/mBEA7PKDmiY?si=2CDiY4ASdIEUIKHz)\n\n-   Statistical Rethinking, Chapter 6.\n:::\n\n## Regression model\n\n+-----------------------------+-------------------------------------------------+\n| **Inference**               | Bayesian                                        |\n+-----------------------------+-------------------------------------------------+\n| **Model**                   | Regression model                                |\n+-----------------------------+-------------------------------------------------+\n| **Outcome variable**        | Vowel duration                                  |\n+-----------------------------+-------------------------------------------------+\n| **Distribution of outcome** | Log-normal                                      |\n+-----------------------------+-------------------------------------------------+\n| **Predictors**              | vowel, distance, speech rate                    |\n+-----------------------------+-------------------------------------------------+\n| **Transformations**         | -   distance: logged and standardised           |\n|                             |                                                 |\n|                             | -   speech rate: logged and standardised        |\n+-----------------------------+-------------------------------------------------+\n| **Effect types**            | non-linear effects for distance and speech rate |\n+-----------------------------+-------------------------------------------------+\n| **Coding**                  | indexing                                        |\n+-----------------------------+-------------------------------------------------+\n| **Varying effects**         | -   by-speaker distance, by vowel               |\n|                             |                                                 |\n|                             | -   by-speaker speech rate                      |\n+-----------------------------+-------------------------------------------------+\n\n## Regression model: code\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbm <- brm(\n  vowel_duration ~\n    0 + vowel +\n    s(distance_logz) +\n    s(distance_logz, speaker, by = vowel, bs = \"fs\", m = 1) +\n    s(speech_rate_logz, k = 5) +\n    s(speech_rate_logz, speaker, bs = \"fs\", m = 1),\n  family = lognormal\n)\n```\n:::\n\n\n\n## Statistical hypotheses\n\n::: box-note\nA. There is no robust effect of vowel but there is a robust (non-linear) effect of distance.\n\nB. There is a robust effect of vowel but there is no robust effect of distance.\n\nC. There is both an effect of vowel and distance.\n:::\n\n## Simulate data\n\n::: box-tip\nCheck the [faux](https://debruine.github.io/faux/index.html) package, although it might not actively developed anymore.\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(9817)\n\ns_n <- 20\nrep_n <- 10\nvdur_m <- 75\nvdur_a <- 20; vdur_e <- 10; vdur_i <- -15; vdur_o <- 10; vdur_u <- -22\ndist_a <- 8; dist_e <- 4.5; dist_i <- 2; dist_o <- 6; dist_u <- 2\ndist_sd <- 0.2\nb_dist <- 0.8\nb_sr <- 0.01\nsr_m <- 4\n# varying duration\ndur_spk_sd <- 5\ndur_rep_sd <- 2\n# varying distance\ndist_spk_sd <- 0.05\ndist_rep_sd <- 0.05\n# varying sr\nsr_spk_sd <- 0.005\nsr_rep_sd <- 0.005\n\nsigma_sd <- 20\n\nsim_data <- add_random(speaker = s_n) |> \n  add_within(\"speaker\", vowel = c(\"a\", \"e\", \"i\", \"o\", \"u\")) |> \n  add_within(\"vowel\", rep = 1:rep_n) |> \n  add_ranef(\"speaker\", dur_spk = dur_spk_sd) |> \n  add_ranef(\"rep\", dur_rep = dur_rep_sd) |> \n  add_ranef(\"speaker\", dist_spk = dist_spk_sd) |> \n  add_ranef(\"rep\", dist_rep = dist_rep_sd) |>\n  add_ranef(\"speaker\", sr_spk = sr_spk_sd) |> \n  add_ranef(\"rep\", sr_rep = sr_rep_sd) |> \n  add_ranef(sigma = sigma_sd) |> \n  add_ranef(sigma_dist = dist_sd) |> \n  mutate(\n    distance = case_when(\n      vowel == \"a\" ~ dist_a + dist_spk + dist_rep + sigma_dist,\n      vowel == \"e\" ~ dist_e + dist_spk + dist_rep + sigma_dist,\n      vowel == \"i\" ~ dist_i + dist_spk + dist_rep + sigma_dist,\n      vowel == \"o\" ~ dist_o + dist_spk + dist_rep + sigma_dist,\n      vowel == \"u\" ~ dist_u + dist_spk + dist_rep + sigma_dist\n    ),\n    speech_rate = sr_m + sr_spk + sr_rep\n  ) |> \n  mutate(\n    vowel_duration = case_when(\n      vowel == \"a\" ~ vdur_m + vdur_a + dur_spk + dur_rep + (b_dist * distance) + (b_sr * speech_rate) + sigma_sd,\n      vowel == \"e\" ~ vdur_m + vdur_e + dur_spk + dur_rep + (b_dist * distance) + (b_sr * speech_rate) + sigma_sd,\n      vowel == \"i\" ~ vdur_m + vdur_i + dur_spk + dur_rep + (b_dist * distance) + (b_sr * speech_rate) + sigma_sd,\n      vowel == \"o\" ~ vdur_m + vdur_o + dur_spk + dur_rep + (b_dist * distance) + (b_sr * speech_rate) + sigma_sd,\n      vowel == \"u\" ~ vdur_m + vdur_u + dur_spk + dur_rep + (b_dist * distance) + (b_sr * speech_rate) + sigma_sd\n    ),\n    distance_log = log(distance),\n    distance_logz = (distance_log - mean(distance_log)) / sd(distance_log),\n    speech_rate_log = log(speech_rate),\n    speech_rate_logz = (speech_rate_log - mean(speech_rate_log)) / sd(speech_rate_log)\n  )\n```\n:::\n\n\n\n## Simulate data: plot\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](data-analysis-workflow-2_files/figure-revealjs/sim-data-plot-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Simulate data: model\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbm <- brm(\n  vowel_duration ~\n    0 + vowel +\n    s(distance_logz) +\n    s(distance_logz, speaker, by = vowel, bs = \"fs\", m = 1) +\n    s(speech_rate_logz, k = 5) +\n    s(speech_rate_logz, speaker, bs = \"fs\", m = 1),\n  family = lognormal,\n  data = sim_data,\n  cores = 4,\n  seed = 7162,\n  file = \"cache/data-analysis-workflow-2_bm\"\n)\n```\n:::\n\n\n\n::: box-important\nThis took 40 minutes to run and ended in 218 divergent transitions. You would normally also specify priors and try and fix the divergent transitions (and in the case of non-linear effects you might also want to estimate the number of knots before fitting).\n:::\n\n## Simulate data: model summary\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nconditional_effects(bm, \"distance_logz:vowel\")\n```\n\n::: {.cell-output-display}\n![](data-analysis-workflow-2_files/figure-revealjs/unnamed-chunk-6-1.png){fig-align='center' width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}