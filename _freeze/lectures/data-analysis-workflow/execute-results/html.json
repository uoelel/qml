{
  "hash": "e3e578d0e50242124244ae4293f81da3",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data analysis workflow\"\nauthor: \"Stefano Coretta\"\nformat: mono-light-revealjs\neditor: source\nfilters:\n  - tachyonsextra\nexecute: \n  echo: true\nknitr: \n  opts_chunk: \n    fig.width: 7\n    fig.align: center\n---\n\n\n\n\n\n\n## Research process cycle: Overview\n\n![](/img/res-process-cycle.png){fig-align=\"center\"}\n\n## Research questions and hypothesis\n\n::: box-note\n-   Research **questions** are testable questions.\n\n-   Research **hypotheses** are falsifiable statements.\n\n-   Check again [this entry](../posts/research-qh.qmd).\n:::\n\n. . .\n\n::: box-tip\nTwo case studies:\n\n-   **Descriptive and exploratory**: Do British infants use a different number of gestures depending on their cultural background?\n\n-   **Explanatory and corroboratory**: vowel duration and gesture distance.\n:::\n\n## British infants' gestures: Study design\n\n::: box-note\n-   Published paper: <https://www.doi.org/10.1111/cdev.13406>\n\n-   Three cultural backgrounds: English, Bangladeshi and Cantonese.\n\n-   At least 20 infants per background.\n\n-   Laboratory setting, three tasks.\n:::\n\n. . .\n\n::: box-note\n**Analysis plan** (gesture count by background)\n\n-   Summaries with median and range.\n\n-   Visualisation with strip charts.\n\n-   Regression models\n\n    -   Outcome variable: gesture count → [Poisson family](../posts/regression-poisson.qmd).\n\n    -   Predictors: cultural background.\n:::\n\n## British infants' gestures: Data simulation\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\nN <- 20\nbackground <- c(\"English\", \"Bangladeshi\", \"Cantonese\")\ncount_en <- rpois(N, 4)\ncount_ba <- rpois(N, 1)\ncount_ca <- rpois(N, 1.5)\n\ngestures_sim <- tibble(\n  background = rep(background, each = N),\n  count = c(count_en, count_ba, count_ca)\n)\n\ngestures_sim\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 60 × 2\n   background count\n   <chr>      <int>\n 1 English        2\n 2 English        5\n 3 English        4\n 4 English        3\n 5 English        3\n 6 English        5\n 7 English        3\n 8 English        6\n 9 English        3\n10 English        5\n# ℹ 50 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## British infants' gestures: Data simulation (summarise)\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngestures_sim |> \n  group_by(background) |> \n  summarise(median(count), min(count), max(count))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  background  `median(count)` `min(count)` `max(count)`\n  <chr>                 <dbl>        <int>        <int>\n1 Bangladeshi               1            0            2\n2 Cantonese                 1            0            6\n3 English                   4            1            9\n```\n\n\n:::\n:::\n\n\n\n\n## British infants' gestures: Data simulation (plotting)\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngestures_sim |> \n  ggplot(aes(background, count)) +\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](data-analysis-workflow_files/figure-revealjs/gestures-sim-plot-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## British infants' gestures: Data simulation (model)\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(brms)\n\ngestures_sim_bm <- brm(\n  count ~ 0 + background,\n  family = poisson,\n  data = gestures_sim,\n  cores = 4,\n  seed = 9527,\n  file = \"cache/gestures_sim_bm\"\n)\n```\n:::\n\n\n\n\n## British infants' gestures: Data simulation (model)\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummary(gestures_sim_bm, prob = 0.8)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Family: poisson \n  Links: mu = log \nFormula: count ~ 0 + background \n   Data: gestures_sim (Number of observations: 60) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n                      Estimate Est.Error l-80% CI u-80% CI Rhat Bulk_ESS\nbackgroundBangladeshi     0.20      0.20    -0.05     0.45 1.00     3695\nbackgroundCantonese       0.39      0.18     0.16     0.62 1.00     3934\nbackgroundEnglish         1.35      0.11     1.21     1.49 1.00     3935\n                      Tail_ESS\nbackgroundBangladeshi     2480\nbackgroundCantonese       2837\nbackgroundEnglish         2974\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n\n\n:::\n:::\n\n\n\n\n## British infants' gestures: Data simulation (model)\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nconditional_effects(gestures_sim_bm, prob = 0.8)\n```\n\n::: {.cell-output-display}\n![](data-analysis-workflow_files/figure-revealjs/gestures-sim-bm-cond-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## British infants' gestures: Data acquisition\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngestures <- read_csv(\"data/cameron2020/gestures.csv\") |> \n  group_by(background, dyad) |> \n  summarise(\n    count_sum = sum(count, na.rm = TRUE)\n  ) |> \n  drop_na(count_sum)\ngestures\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 60 × 3\n# Groups:   background [3]\n   background dyad  count_sum\n   <chr>      <chr>     <dbl>\n 1 Bengali    b01          17\n 2 Bengali    b02          36\n 3 Bengali    b03          43\n 4 Bengali    b04          50\n 5 Bengali    b05          33\n 6 Bengali    b06          24\n 7 Bengali    b07          16\n 8 Bengali    b08          37\n 9 Bengali    b09          26\n10 Bengali    b10          13\n# ℹ 50 more rows\n```\n\n\n:::\n:::\n\n\n\n\n## British infants' gestures: Summarise\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngestures |> \n  group_by(background) |> \n  summarise(median(count_sum), min(count_sum), max(count_sum))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  background `median(count_sum)` `min(count_sum)` `max(count_sum)`\n  <chr>                    <dbl>            <dbl>            <dbl>\n1 Bengali                   36.5                5               81\n2 Chinese                   32.5                1              108\n3 English                   20                  1              164\n```\n\n\n:::\n:::\n\n\n\n\n## British infants' gestures: Plot\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngestures |> \n  ggplot(aes(background, count_sum)) +\n  geom_jitter(width = 0.1)\n```\n\n::: {.cell-output-display}\n![](data-analysis-workflow_files/figure-revealjs/gestures-plot-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## British infants' gestures: Model\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ngestures_bm <- brm(\n  count_sum ~ 0 + background,\n  family = poisson,\n  data = gestures,\n  cores = 4,\n  seed = 9527,\n  file = \"cache/gestures_bm\"\n)\n```\n:::\n\n\n\n\n## British infants' gestures: Model summary\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummary(gestures_bm, prob = 0.8)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Family: poisson \n  Links: mu = log \nFormula: count_sum ~ 0 + background \n   Data: gestures (Number of observations: 60) \n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\n         total post-warmup draws = 4000\n\nRegression Coefficients:\n                  Estimate Est.Error l-80% CI u-80% CI Rhat Bulk_ESS Tail_ESS\nbackgroundBengali     3.63      0.04     3.58     3.68 1.00     4227     3072\nbackgroundChinese     3.60      0.04     3.55     3.65 1.00     4388     3001\nbackgroundEnglish     3.38      0.04     3.32     3.43 1.00     3644     2852\n\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\nand Tail_ESS are effective sample size measures, and Rhat is the potential\nscale reduction factor on split chains (at convergence, Rhat = 1).\n```\n\n\n:::\n:::\n\n\n\n\n## British infants' gestures: Conditional posteriors\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nconditional_effects(gestures_bm, prob = 0.8)\n```\n\n::: {.cell-output-display}\n![](data-analysis-workflow_files/figure-revealjs/gestures-bm-cond-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## British infants' gestures: Conditional predictions\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(marginaleffects)\n\navg_predictions(gestures_bm, variables = \"background\", conf_level = 0.8)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n background Estimate 10.0 % 90.0 %\n    Bengali     37.7   36.0   39.5\n    Chinese     36.6   34.9   38.4\n    English     29.3   27.8   30.8\n\nType:  response \nColumns: background, estimate, conf.low, conf.high \n```\n\n\n:::\n:::\n\n\n\n\n## British infants' gestures: Comparisons\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\navg_comparisons(gestures_bm, variables = list(background = \"pairwise\"), conf_level = 0.8)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n                      Contrast Estimate 10.0 % 90.0 %\n mean(Chinese) - mean(Bengali)    -1.07  -3.43   1.44\n mean(English) - mean(Bengali)    -8.37 -10.78  -6.07\n mean(English) - mean(Chinese)    -7.31  -9.72  -5.06\n\nTerm: background\nType:  response \nColumns: term, contrast, estimate, conf.low, conf.high, predicted_lo, predicted_hi, predicted, tmp_idx \n```\n\n\n:::\n:::\n\n\n\n\n## British infants' gestures: Interpretation\n\n::: box-tip\n-   The 80% CrIs of the predicted number of gestures are:\n\n    -   Bengali: 36--40.\n\n    -   Chinese: 35--38.\n\n    -   English: 28--31.\n\n-   English infants performed a lower number of gestures (5 to 11 gestures less than Chinese and Bengali infants at 80% confidence).\n\n-   Chinese and Bengali children have very similar predicted numbers of gestures. Their difference is between -3.5 to +1.5 gestures at 80% confidence.\n:::\n\n## British infants' gestures: Reporting\n\n> We fitted a Bayesian regression model to the number of gestures produced by each infant, using a Poisson distribution. As the only predictor, we included cultural background (Bengali, Chinese, English). This predictor was coded using indexing (by suppressing the intercept with `0 +` in the model formula).\n>\n> Based on the model and data, the number of gestures by cultural background are 36--40 for Bengali infants, 35--38 for Chinese infants, and 28-31 for English infants, at 80% confidence. When comparing each cultural background, there is an 80% probability that the difference in gesture number is between -3.5 and 1.5 for Bengali vs Chinese, -11 and -6 for English vs Bengali, and -10 and -5 for English vs Chinese.\n\n## British infants' gestures: Research question\n\n::: box-tip\nDo British infants use a different number of gestures depending on their cultural background?\n:::\n\n. . .\n\n::: box-note\nBased on the model and data, while Bengali and Chinese infants have a very similar number of gestures, English infants have a somewhat lower count relative to the other two groups.\n:::\n\n## In the next lecture...\n\n::: box-tip\nDoes the distance the tongue has to travel to produce a vowel determines the duration of the vowel?\n:::\n\n![](/img/vdur-dags-3a.png){fig-align=\"center\"}\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}